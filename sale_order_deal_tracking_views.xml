<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <!-- Extend Sale Order Form View with Deal Tracking Information -->
        <record id="sale_order_form_view_deal_tracking" model="ir.ui.view">
            <field name="name">sale.order.form.deal.tracking</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">

                <!-- Add Deal Information Section after customer info -->
                <xpath expr="//field[@name='partner_id']" position="after">
                    <div class="row mt-3 mb-3" style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                        <div class="col-md-12">
                            <h5 style="color: #8b1538; font-weight: bold; margin-bottom: 10px;">
                                BROKERAGE DEAL INFORMATION
                            </h5>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <field name="buyer_name" readonly="1" widget="char" class="bg-light"/>
                        </div>
                        <div class="col-md-6">
                            <field name="project_name" readonly="1" widget="char" class="bg-light"/>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <field name="unit_sale_value" readonly="1" widget="monetary" class="bg-light"/>
                        </div>
                        <div class="col-md-6">
                            <field name="primary_commission_percentage" readonly="1" widget="float"/>
                            <span>%</span>
                        </div>
                    </div>

                    <!-- Deal Summary Widget -->
                    <div class="row mt-2">
                        <div class="col-md-12">
                            <field name="deal_summary_html" widget="html" nolabel="1" readonly="1"/>
                        </div>
                    </div>
                </xpath>

            </field>
        </record>

        <!-- Extend Sale Order Tree View with Deal Columns -->
        <record id="sale_order_tree_view_deal_tracking" model="ir.ui.view">
            <field name="name">sale.order.tree.deal.tracking</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.order_tree"/>
            <field name="arch" type="xml">

                <!-- Add deal columns to tree view after order name -->
                <xpath expr="//field[@name='name']" position="after">
                    <field name="buyer_name" string="Buyer" width="15%"/>
                    <field name="project_name" string="Project" width="15%"/>
                    <field name="unit_sale_value" string="Unit Price" width="12%"/>
                    <field name="primary_commission_percentage" string="Commission %" width="10%"/>
                </xpath>

            </field>
        </record>

        <!-- Smart Button for Deal Information -->
        <record id="sale_order_form_view_deal_button" model="ir.ui.view">
            <field name="name">sale.order.form.deal.button</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">

                <!-- Add smart button in header -->
                <xpath expr="//header" position="inside">
                    <button name="action_view_deal_summary" type="object" class="oe_highlight" string="View Deal Summary" icon="fa-info-circle" style="background-color: #8b1538; color: white;"/>
                </xpath>

            </field>
        </record>

    </data>
</odoo>
