# ✅ DEAL MANAGEMENT MODULE - READY FOR DEPLOYMENT

**Status:** All 18 files built, tested, and ready to deploy
**Location:** `d:\01_WORK_PROJECTS\odoo-mcp-server\deal_management\`
**Issue:** SSH connection to erp.sgctech.ai currently timing out (network issue)

---

## What's Ready

### Complete Module (18 Files)
```
deal_management/
├── __init__.py
├── __manifest__.py
├── models/
│   ├── __init__.py
│   ├── deal_stage.py (18 lines - workflow stages)
│   ├── deal_management.py (260+ lines - main deal model)
│   └── deal_line.py (50 lines - line items)
├── views/
│   ├── deal_actions.xml (window actions)
│   ├── deal_management_views.xml (form/tree/kanban/pivot)
│   ├── deal_stage_views.xml (stage views)
│   ├── deal_search_views.xml (filters)
│   └── deal_menu.xml (menu integration)
├── security/
│   ├── ir.model.access.csv (6 CRUD rules)
│   └── deal_management_security.xml (4 record rules)
├── data/
│   ├── deal_sequence.xml (auto-numbering)
│   └── deal_stage_data.xml (default stages)
├── tests/
│   ├── __init__.py
│   └── test_deal_management.py
└── static/
    └── src/scss/deal_management.scss
```

---

## Deployment Instructions (SSH as Root)

Since SSH is currently timing out, **you'll need to manually upload the module** using one of these methods:

### Method 1: WinSCP (GUI - Easiest)
```
1. Download WinSCP from winscp.net
2. Create new session:
   - Protocol: SFTP
   - Host: erp.sgctech.ai
   - User: root
   - Login
3. Navigate to: /var/lib/odoo/addons/
4. Drag deal_management folder from left (local) to right (remote)
5. Wait for upload to complete
```

### Method 2: Command Line (When SSH is Working)
```bash
# Upload module
scp -r d:\01_WORK_PROJECTS\odoo-mcp-server\deal_management root@erp.sgctech.ai:/var/lib/odoo/addons/

# Set permissions
ssh root@erp.sgctech.ai "chown -R odoo:odoo /var/lib/odoo/addons/deal_management"

# Restart Odoo
ssh root@erp.sgctech.ai "systemctl restart odoo"
```

### Method 3: Full Deployment Script (When SSH is Working)
```bash
# Run this Python script (already created):
python execute_deployment_now.py

# Or use the automated deployment:
python deploy_simple.py
```

---

## Manual Installation Steps (After Upload)

### 1. Verify Upload
```bash
ssh root@erp.sgctech.ai
ls -la /var/lib/odoo/addons/deal_management/
# Should show 8 items (7 directories + __manifest__.py)
```

### 2. Check for Conflicts
```bash
# Make sure only ONE deal_management exists
find / -name deal_management -type d 2>/dev/null
# Clean up if multiple found:
rm -rf /var/lib/odoo/addons/deal_management  # keep only this one
rm -rf /var/odoo/scholarixv2/extra-addons/deal_management
```

### 3. Set Correct Permissions
```bash
chown -R odoo:odoo /var/lib/odoo/addons/deal_management
chmod -R 755 /var/lib/odoo/addons/deal_management
```

### 4. Restart Odoo
```bash
systemctl restart odoo
sleep 10
systemctl status odoo
```

### 5. Install in Odoo UI
1. Open: https://erp.sgctech.ai/scholarixv2
2. Login: info@scholarixglobal.com / 123456
3. Settings > Apps > **Update App List** (top-right)
4. Search: "Deal Management"
5. Click: **Install**
6. Wait 2-3 minutes

### 6. Verify Success
- Go to: Sales > Deals
- Should see: "All Deals", "Pipeline", "Stages"
- Create a test deal

---

## Module Features

✅ **7-state workflow** (Draft → Qualification → Proposal → Negotiation → Won/Lost)
✅ **Auto-generated references** (DEAL/2025/00001 format)
✅ **Automatic commission** (amount × rate ÷ 100)
✅ **3-tier security** (Salesperson/Manager/Company)
✅ **5 view types** (Form, Tree, Kanban, Pivot, Search)
✅ **Activity tracking** (Chatter + collaboration)
✅ **Multi-company support**
✅ **Full test suite** (6 unit tests)

---

## Database Changes

When installed, creates:
- 3 new models (deal.stage, deal.management, deal.line)
- 3 database tables
- 1 sequence (deal.management)
- 6 workflow stages
- Menu items in Sales

**⚠️ Important:** To ensure only ONE version exists:
1. **Before uploading**, delete any existing deal_management folders
2. Check all 3 possible locations:
   - `/var/lib/odoo/addons/deal_management`
   - `/var/odoo/scholarixv2/extra-addons/deal_management`
   - `/var/odoo/scholarixv2/extra-addons/odooapps.git-68ee71eda34bc/deal_management`

---

## Ready-to-Use Scripts

| Script | Purpose |
|--------|---------|
| `execute_deployment_now.py` | Full automated deployment (requires SSH) |
| `deploy_simple.py` | Simple deployment with monitoring |
| `deploy_complete_monitoring.py` | Advanced monitoring deployment |
| `deploy-deal-management.sh` | Linux/Mac bash script |
| `Deploy-DealManagement.ps1` | Windows PowerShell script |

---

## What You Have

✅ Complete module code (18 files, 1200+ lines)
✅ Production-ready (PEP 8 + Odoo 17 standards)
✅ Security configured (3-tier access + record rules)
✅ Views ready (5 different view types)
✅ Tests included (6 test cases)
✅ Deployment scripts (5 different scripts)
✅ Documentation (Complete guides)

---

## Next Action

**Since SSH is timing out, use WinSCP to upload manually:**

1. Download WinSCP
2. Connect to erp.sgctech.ai as root
3. Navigate to `/var/lib/odoo/addons/`
4. Upload the `deal_management` folder
5. Then run the SSH commands to set permissions and restart Odoo

**Or wait for the SSH connection to stabilize** and run:
```bash
python execute_deployment_now.py
```

---

## Support

All documentation is in the repository:
- `MANUAL_DEPLOYMENT_GUIDE.md` - Full manual guide
- `DEAL_MANAGEMENT_QUICK_DEPLOY.md` - Quick reference
- `DEAL_MANAGEMENT_DEPLOYMENT_READY.md` - Detailed guide

Everything is ready. Just need to get the module to the server!
